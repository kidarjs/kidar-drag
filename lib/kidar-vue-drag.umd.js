(function(g,v){typeof exports=="object"&&typeof module!="undefined"?module.exports=v():typeof define=="function"&&define.amd?define(v):(g=typeof globalThis!="undefined"?globalThis:g||self,g.KI_DRAG_CONTAINER=v())})(this,function(){"use strict";var g=typeof global=="object"&&global&&global.Object===Object&&global,v=g,q=typeof self=="object"&&self&&self.Object===Object&&self,J=v||q||Function("return this")(),k=J,Q=k.Symbol,S=Q,W=Object.prototype,Z=W.hasOwnProperty,ee=W.toString,y=S?S.toStringTag:void 0;function te(e){var t=Z.call(e,y),n=e[y];try{e[y]=void 0;var i=!0}catch(s){}var r=ee.call(e);return i&&(t?e[y]=n:delete e[y]),r}var ne=Object.prototype,ie=ne.toString;function re(e){return ie.call(e)}var se="[object Null]",oe="[object Undefined]",D=S?S.toStringTag:void 0;function ae(e){return e==null?e===void 0?oe:se:D&&D in Object(e)?te(e):re(e)}function le(e){return e!=null&&typeof e=="object"}var fe="[object Symbol]";function de(e){return typeof e=="symbol"||le(e)&&ae(e)==fe}var ce=/\s/;function ue(e){for(var t=e.length;t--&&ce.test(e.charAt(t)););return t}var me=/^\s+/;function he(e){return e&&e.slice(0,ue(e)+1).replace(me,"")}function x(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var M=0/0,be=/^[-+]0x[0-9a-f]+$/i,pe=/^0b[01]+$/i,ge=/^0o[0-7]+$/i,ve=parseInt;function H(e){if(typeof e=="number")return e;if(de(e))return M;if(x(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=x(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=he(e);var n=pe.test(e);return n||ge.test(e)?ve(e.slice(2),n?2:8):be.test(e)?M:+e}var ye=function(){return k.Date.now()},j=ye,_e="Expected a function",Te=Math.max,Ee=Math.min;function we(e,t,n){var i,r,s,d,a,o,u=0,N=!1,h=!1,m=!0;if(typeof e!="function")throw new TypeError(_e);t=H(t)||0,x(n)&&(N=!!n.leading,h="maxWait"in n,s=h?Te(H(n.maxWait)||0,t):s,m="trailing"in n?!!n.trailing:m);function E(l){var b=i,w=r;return i=r=void 0,u=l,d=e.apply(w,b),d}function O(l){return u=l,a=setTimeout($,t),N?E(l):d}function We(l){var b=l-o,w=l-u,K=t-b;return h?Ee(K,s-w):K}function B(l){var b=l-o,w=l-u;return o===void 0||b>=t||b<0||h&&w>=s}function $(){var l=j();if(B(l))return U(l);a=setTimeout($,We(l))}function U(l){return a=void 0,m&&i?E(l):(i=r=void 0,d)}function De(){a!==void 0&&clearTimeout(a),u=0,i=o=r=a=void 0}function Me(){return a===void 0?d:U(j())}function R(){var l=j(),b=B(l);if(i=arguments,r=this,o=l,b){if(a===void 0)return O(o);if(h)return clearTimeout(a),a=setTimeout($,t),E(o)}return a===void 0&&(a=setTimeout($,t)),d}return R.cancel=De,R.flush=Me,R}var Se="Expected a function";function xe(e,t,n){var i=!0,r=!0;if(typeof e!="function")throw new TypeError(Se);return x(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),we(e,t,{leading:i,maxWait:t,trailing:r})}let f,c,p,A,z;const C=e=>{e.style.position="absolute",e.style.width="8px",e.style.height="8px",e.style.backgroundColor="#ffffff",e.style.border="1px solid #333"},X=(()=>{let e;return()=>{if(e)return e;const t=document.createElement("div");t.className="__border_line",t.style.position="absolute",t.style.left="0",t.style.right="0",t.style.top="0",t.style.bottom="0",t.style.border="1px dashed #666";const n=document.createElement("div");n.className="__dot_lt",C(n),n.style.cursor="nw-resize",n.style.left="-4px",n.style.top="-4px";const i=document.createElement("div");i.className="__dot_lb",C(i),i.style.cursor="ne-resize",i.style.left="-4px",i.style.bottom="-4px";const r=document.createElement("div");r.className="__dot_rt",C(r),r.style.cursor="ne-resize",r.style.right="-4px",r.style.top="-4px";const s=document.createElement("div");return s.className="__dot_rb",C(s),s.style.cursor="nw-resize",s.style.right="-4px",s.style.bottom="-4px",e=[t,n,i,r,s],e}})(),Ce=(e,t)=>{let{offsetHeight:n,offsetWidth:i}=f;t<0&&(t=0),e<0&&(e=0),e+i>c.offsetWidth&&(e=c.offsetWidth-i),t+n>c.offsetHeight&&(t=c.offsetHeight-n),f.style.left=Number(e)/Number(c.clientWidth)*100+"%",f.style.top=Number(t)/Number(c.clientHeight)*100+"%"},_=xe(function(e,t,n,i){f.style.width=Number(n)/Number(c.clientWidth)*100+"%",f.style.height=Number(i)/Number(c.clientHeight)*100+"%",Ce(e,t)},100),Ne=e=>{f!==e&&f&&I(f),e.innerHTML.indexOf("__border_line")===-1&&e.append(...X())},I=e=>{e&&e.innerHTML.indexOf("__border_line")>-1&&X().forEach(t=>{e.removeChild(t)})},P=(e,t)=>e.parentElement===t?(Ne(e),f=e,!0):e.parentElement?P(e.parentElement,t):!1,V=e=>{let{target:t,currentTarget:n,pageX:i,pageY:r}=e;t instanceof HTMLElement&&n instanceof HTMLElement&&(t.className.startsWith("__dot")?(p=t.className.substring(6,8),n.style.cursor=p==="lt"||p==="rb"?"nw-resize":"ne-resize"):P(t,n)?(p="move",n.style.cursor="move",A=i-f.offsetLeft,z=r-f.offsetTop):I(f),c=n)},Oe=e=>t=>{p="",c&&(c.style.cursor="auto"),f&&e&&e(f)};let L;const F=e=>{if(!p)return;let{pageY:t,pageX:n}=e,{offsetLeft:i,offsetTop:r,offsetHeight:s,offsetWidth:d}=f,a=n-c.offsetLeft,o=t-c.offsetTop;switch(p){case"rb":_(i,r,a-i,o-r);break;case"rt":o>r+s&&(o=r+s),_(i,o,a-i,s-o+r);break;case"lt":o>r+s&&(o=r+s),a>i+d&&(a=i+d),_(a,o,d-a+i,s-o+r);break;case"lb":a>i+d&&(a=i+d),_(a,r,d-a+i,o-r);break;case"move":c.style.cursor="move",_(n-A,t-z,d,s);break}};var G={active:(e,t)=>{L=Oe(t),e.style.userSelect="none",e.addEventListener("mousedown",V),e.addEventListener("mouseup",L),e.addEventListener("mousemove",F)},clear:e=>{e.style.userSelect="inherit",e.removeEventListener("mousedown",V),e.removeEventListener("mouseup",L),e.removeEventListener("mousemove",F),f&&I(f)}},$e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"dragContainer",staticStyle:{position:"relative",height:"100%",width:"100%","background-color":"#f1f1f1"}},e._l(e.items,function(i,r){return n("div",{key:i.id,style:"position: absolute;width:"+i.width+";height:"+i.height+";left:"+i.left+";top:"+i.top+";min-width:"+i.minWidth+";",attrs:{"dataset-drag-index":r}},[n("div",{staticClass:"__drag-item",staticStyle:{height:"100%",width:"100%",position:"absolute",top:"50%",left:"50%",transform:"translateX(-50%) translateY(-50%)"}},[e._t("item",null,{item:i})],2),e.isCanDel?n("button",{staticStyle:{position:"absolute",right:"4px"},on:{click:function(s){return e.deleteItem(r,i)}}},[n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 24 24",width:"1em",fill:"currentColor"}},[n("path",{attrs:{d:"M0 0h24v24H0V0z",fill:"none"}}),n("path",{attrs:{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"}})])]):e._e()])}),0)},je=[];function Ie(e,t,n,i,r,s,d,a){var o=typeof e=="function"?e.options:e;t&&(o.render=t,o.staticRenderFns=n,o._compiled=!0),i&&(o.functional=!0),s&&(o._scopeId="data-v-"+s);var u;if(d?(u=function(m){m=m||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!m&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(m=__VUE_SSR_CONTEXT__),r&&r.call(this,m),m&&m._registeredComponents&&m._registeredComponents.add(d)},o._ssrRegister=u):r&&(u=a?function(){r.call(this,(o.functional?this.parent:this).$root.$options.shadowRoot)}:r),u)if(o.functional){o._injectStyles=u;var N=o.render;o.render=function(E,O){return u.call(O),N(E,O)}}else{var h=o.beforeCreate;o.beforeCreate=h?[].concat(h,u):[u]}return{exports:e,options:o}}const Le={name:"KiDragContainer",props:{editable:{type:Boolean,default:!0},items:{type:Array,default:()=>[]}},watch:{items:{handler:function(e,t){this.$emit("changed",e)},deep:!0},editable:function(e){e?this.active():this.disable()}},data(){return{isCanDel:!0}},mounted(){this.$nextTick(()=>{this.editable&&this.active()})},beforeDestroy(){this.disable()},methods:{deleteItem(e,t){this.$emit("delete",e,t)},updateItem(e){let{width:t,height:n,left:i,top:r}=e.style,s=e.getAttribute("dataset-drag-index");(this.items[s].width!==t||this.items[s].height!==n||this.items[s].left!==i||this.items[s].top!==r)&&(this.items[s].width=t,this.items[s].height=n,this.items[s].left=i,this.items[s].top=r,this.$emit("changed",this.items))},active(){G.active(this.$refs.dragContainer,this.updateItem),this.isCanDel=!0},disable(){G.clear(this.$refs.dragContainer),this.isCanDel=!1}}},Y={};var Re=Ie(Le,$e,je,!1,ke,null,null,null);function ke(e){for(let t in Y)this[t]=Y[t]}var T=function(){return Re.exports}();return T.install=e=>{e.component(T.name,T)},typeof window!="undefined"&&window.Vue&&T.install(window.Vue),T});
